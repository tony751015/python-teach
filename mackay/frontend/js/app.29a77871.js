(function(){"use strict";var e={1677:function(e,t,r){r(4114),r(4603),r(7566),r(8721);var o=r(5471),n=r(6895),i=r(9397),s=r(4366),a=function(){var e=this,t=e._self._c;return t(i.A,[e.alert.show?t(n.A,{staticClass:"login-alert text-center",attrs:{dense:"",transition:"scale-transition",value:e.alert_timeout,type:e.alert.status}},[e._v(" "+e._s(e.alert.message)+" ")]):e._e(),t(s.A,[t("router-view")],1)],1)},u=[],c=r(5353),l=r(127),d={name:"App",data:()=>({alertShow:!1,alertStatus:"",alert_timeout:!0,timer:""}),mounted(){console.log("this.$route",this.$route),console.log("this.$route.name",this.$route.name),window.addEventListener("resize",this.clientWidthResize),this.$nextTick((()=>{this.clientWidthResize()})),this.checkURL(location.href)},methods:{...(0,c.PY)({updateRwdType:"SET_RWD_TYPE"}),checkURL(e){try{const t=new URL(e);return console.log("URL:",e),console.log("Origin:",t.origin),console.log("Pathname:",t.pathname),console.log("path:",this.PATH_CHECK),t.origin!=this.PATH_CHECK||"/"!=t.pathname?(console.log("網址不符合條件"),this.autoRelogin(),"網址不符合條件"):"網址符合條件"}catch(t){return console.log("網址格式錯誤:",t),"網址格式錯誤"}},detectAutoLoginProcess(){const e=localStorage.getItem("mackay"),t=JSON.parse(localStorage.getItem("mackay"));if(console.log("getJWTData_id",t.user_id),e){const r=l(e),{exp:o}=r,n=Date.now()/1e3;if(console.log("JWT content: ",r),o-n>0){const e={name:r.name,line_id:r.sub,thumb:r.picture};this.updateUserProfile(e),this.updateUserId(t.user_id),this.updateUserLogin(!0),this.updateAlert({show:!0,status:"success",message:"Login ok!"})}this.$router.push("/chat/"+t.user_id)}else this.updateUserProfile({}),this.updateUserLogin(!1),this.updateAlert({show:!0,status:"error",message:"Please log in again!"}),this.$router.push("/")},clientWidthResize(){this.clientWidth=document.documentElement.clientWidth,this.clientHeight=document.documentElement.clientHeight,this.clientWidth>=1280?this.updateRwdType("desktop"):this.clientWidth<1280&&this.clientWidth>1080?this.updateRwdType("tablet"):this.clientWidth<=1080&&this.clientWidth>730?this.updateRwdType("tablet-m"):this.updateRwdType("mobile"),console.log("CHECK RWDTYPE",this.getRwdType)}},watch:{"alert.show"(e){e&&(this.alert_timeout=!0,setTimeout((()=>{this.alert_timeout=!1,this.updateAlert({show:!1,status:"",message:""})}),3e3))}},computed:{...(0,c.L8)({getRwdType:"exportRwdType"})}},h=d,p=r(845),f=(0,p.A)(h,a,u,!1,null,null,null),m=f.exports,g=r(173);const _=()=>Promise.all([r.e(118),r.e(129),r.e(795)]).then(r.bind(r,1795)),y=()=>Promise.all([r.e(118),r.e(129),r.e(164)]).then(r.bind(r,8164)),A=()=>Promise.all([r.e(118),r.e(108)]).then(r.bind(r,5108)),b=()=>r.e(931).then(r.bind(r,9931)),v=()=>r.e(541).then(r.bind(r,1541));o.Ay.use(g.Ay);const w=[{path:"/",name:"woundLogin",component:A},{path:"/chat",name:"chat-list",component:_},{path:"/chat/:id",name:"chat-room",component:y},{path:"/404",name:"error404",component:b},{path:"/500",name:"error500",component:v},{path:"*",redirect:{name:"error404"}}],T=new g.Ay({mode:"history",routes:w});var E=T;o.Ay.use(c.Ay);var U=new c.Ay.Store({state:{user_profile:{},user_login:!1,rwdType:"desktop",alert:{show:!1,status:""},user_Id:null},getters:{exportUserProfile(e){return e.user_profile},exportUserId(e){return e.user_Id},exportChatRoom(e){return e.chat_room},exportUserLogin(e){return e.user_login},exportAlert(e){return e.alert},exportRwdType(e){return e.rwdType}},mutations:{UPDATE_USER_PROFILE(e,t){e.user_profile=t},UPDATE_USER_ID(e,t){e.user_Id=t},UPDATE_CHAT_ROOM(e,t){e.chat_room=t},UPDATE_USER_LOGIN(e,t){e.user_login=t},UPDATE_ALERT(e,t){e.alert=t},SET_USER_ID(e,t){e.user_Id=t},SET_RWD_TYPE(e,t){e.rwdType=t}},actions:{updateUserId({commit:e},t){e("SET_USER_ID",t)}},modules:{}}),R=r(8556),P=r(1269);o.Ay.use(R.A);var L=new R.A({theme:{themes:{light:{primary:"#66bb6a",secondary:"#424242",accent:"#8c9eff",error:"#d8374d",success:"#4CAF50",warning:"#da8200","main-green":"#2D9CA0","v-light":"#eee","v-dark":"#242526","v-dark2":"#161616","color-1":"#d6545c","color-2":"#f98068","color-3":"#f0c158","color-4":"#98cb69","color-5":"#00b69e","pain-1":"#00b69e","pain-2":"#98cb69","pain-3":"#f0c158","pain-4":"#f98068","pain-5":"#d6545c","point-0":"#49954c","point-1":"#fff","point-2":"#f0c158","point-3":"#d6545c","level-4":"#f0c158","level-5":"#d6545c","level-reverse-2":"#f0c158","level-reverse-1":"#d6545c","record-basic":"#5580a0","record-se":"#616eb7","record-se1":"#616eb7","record-se2":"#616eb7","record-event":"#915c4c","record-trail":"#49954c","record-profile":"#ef6357","real-reply":"#ffdd73"}}},lang:{locales:{zhHant:P.A},current:"zhHant"}}),S=(r(6044),r(2252)),I=r.n(S),k=r(4335);o.Ay.prototype.$http=k.A,o.Ay.config.productionTip=!1,o.Ay.component("infinite-loading",I());const C={data:()=>({SERVER_PATH:"//wdcare.net/",VUE_PATH:"//wdcare.net/",IMG_PATH:"https://storage.googleapis.com/wdcare-file-storage/",LINE_ID:"2006754723",LINE_SECRET:"313b67b3c810351c1396b450ac5c35e0",LINE_CALLBACK:"https://wdcare.net/",PATH_CHECK:"https://wdcare.net"}),methods:{...(0,c.PY)({updateUserProfile:"UPDATE_USER_PROFILE",updateUserLogin:"UPDATE_USER_LOGIN",updateUserId:"UPDATE_USER_ID",updateChatRoom:"UPDATE_CHAT_ROOM",updateAlert:"UPDATE_ALERT",updateRwdType:"UPDATE_RWD_TYPE"}),autoRelogin(){const e=localStorage.getItem("mackay"),t=JSON.parse(e);if(console.log("Check JWT",t),e){const e=l(t.jwt),r={name:e.name,line_id:e.sub,thumb:e.picture,id:t.user_id,super_user:t.super_user,room_path:t.room_path};console.log("autoRelogin",r),this.updateUserLogin(!0),this.updateUserProfile(r),this.updateAlert({show:!0,status:"success",message:"Login ok!"})}else{this.updateUserProfile(null),this.updateUserId(null),this.updateUserLogin(!1);const e=new URL(location.href);"/"!==e.pathname&&this.$router.push("/")}},routerRedirectTo404(){this.$router.push({name:"error404"})},userLoginProcess(e,t){return k.A.post(`${this.SERVER_PATH}api/member/line_login`,{code:e,state:t}).then((e=>{const t=e.data.jwt_token;if(t){console.log("JWT content: ",t);const r={jwt:t,user_id:e.data.user_id,super_user:e.data.super_user,room_path:e.data.room_path};localStorage.setItem("mackay",JSON.stringify(r));const o=l(t),n={name:o.name,line_id:o.sub,thumb:o.picture,id:e.data.user_id,super_user:e.data.super_user,room_path:e.data.room_path};this.updateUserProfile(n),this.updateUserId(n.id),this.updateUserLogin(!0),this.updateAlert({show:!0,status:"success",message:"Login ok!"}),console.log("LOGIN STATUS: ",this.userLogin),console.log("USER_PROFILE: ",n)}1==e.data.super_user?this.$router.push("/chat"):this.$router.push("/chat/"+e.data.room_path)})).catch((e=>{console.error("LINE LOGIN Failed:",e),this.updateUserProfile({}),this.updateUserId(""),this.updateUserLogin(!1),this.updateAlert({show:!0,status:"error",message:"Please log in again!"}),localStorage.removeItem("mackay"),this.$router.push("/500")})),!0},logout(){localStorage.removeItem("mackay"),this.updateAlert({show:!0,status:"success",message:"Logged out ok!"}),setTimeout((()=>{this.$router.push("/")}),1e3)}},computed:{...(0,c.L8)({userProfile:"exportUserProfile",userLogin:"exportUserLogin",storeUserId:"exportUserId",storeChatRoom:"exportChatRoom",alert:"exportAlert",getRwdType:"exportRwdType"})}};o.Ay.mixin(C),new o.Ay({router:E,store:U,vuetify:L,render:e=>e(m)}).$mount("#app")}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,o,n,i){if(!o){var s=1/0;for(l=0;l<e.length;l++){o=e[l][0],n=e[l][1],i=e[l][2];for(var a=!0,u=0;u<o.length;u++)(!1&i||s>=i)&&Object.keys(r.O).every((function(e){return r.O[e](o[u])}))?o.splice(u--,1):(a=!1,i<s&&(s=i));if(a){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[o,n,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,o){return r.f[o](e,t),t}),[]))}}(),function(){r.u=function(e){return"js/"+e+"."+{108:"ab769c32",118:"c1d5a904",129:"053f05d7",164:"f6abfdca",541:"8b84ba29",795:"2855355d",931:"22fb8c4c"}[e]+".js"}}(),function(){r.miniCssF=function(e){return"css/"+e+"."+{108:"cac91f52",118:"c38afd2f",129:"acdf8885",164:"8e08518b",541:"18a6f107",795:"d3dc7763",931:"b2555283"}[e]+".css"}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="wound-chat:";r.l=function(o,n,i,s){if(e[o])e[o].push(n);else{var a,u;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+i){a=d;break}}a||(u=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+i),a.src=o),e[o]=[n];var h=function(t,r){a.onerror=a.onload=null,clearTimeout(p);var n=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((function(e){return e(r)})),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),u&&document.head.appendChild(a)}}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="https://storage.googleapis.com/wdcare-file-storage/static/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,n,i){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",r.nc&&(s.nonce=r.nc);var a=function(r){if(s.onerror=s.onload=null,"load"===r.type)n();else{var o=r&&r.type,a=r&&r.target&&r.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+a+")");u.name="ChunkLoadError",u.code="CSS_CHUNK_LOAD_FAILED",u.type=o,u.request=a,s.parentNode&&s.parentNode.removeChild(s),i(u)}};return s.onerror=s.onload=a,s.href=t,o?o.parentNode.insertBefore(s,o.nextSibling):document.head.appendChild(s),s},t=function(e,t){for(var r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var n=r[o],i=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(i===e||i===t))return n}var s=document.getElementsByTagName("style");for(o=0;o<s.length;o++){n=s[o],i=n.getAttribute("data-href");if(i===e||i===t)return n}},o=function(o){return new Promise((function(n,i){var s=r.miniCssF(o),a=r.p+s;if(t(s,a))return n();e(o,a,null,n,i)}))},n={524:0};r.f.miniCss=function(e,t){var r={108:1,118:1,129:1,164:1,541:1,795:1,931:1};n[e]?t.push(n[e]):0!==n[e]&&r[e]&&t.push(n[e]=o(e).then((function(){n[e]=0}),(function(t){throw delete n[e],t})))}}}(),function(){var e={524:0};r.f.j=function(t,o){var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var i=new Promise((function(r,o){n=e[t]=[r,o]}));o.push(n[2]=i);var s=r.p+r.u(t),a=new Error,u=function(o){if(r.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var i=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,n[1](a)}};r.l(s,u,"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,i,s=o[0],a=o[1],u=o[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(u)var l=u(r)}for(t&&t(o);c<s.length;c++)i=s[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(l)},o=self["webpackChunkwound_chat"]=self["webpackChunkwound_chat"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(1677)}));o=r.O(o)})();
//# sourceMappingURL=app.29a77871.js.map